<!-- ***** Footer Area Start ***** -->
<footer class="footer-area">
  <div class="container">
    <div class="row">
      <div class="col-12 col-md-4">
        <div class="footer-single-widget">
          <div class="copywrite-text mt-30">
            <p>
              Copyright &copy;
              <script>
                document.write(new Date().getFullYear());
              </script>
              All rights reserved
            </p>
            <p>Made with by Gyuha</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>
<!-- ***** Footer Area End ***** -->

<script src="/vendor/jquery-2.2.4.min.js"></script>
<script src="/vendor/bootstrap/popper.min.js"></script>
<script src="/vendor/bootstrap/bootstrap.min.js"></script>
<script src="/vendor/native-console.js"></script>
<script src="/vendor/jquery.easing.1.3.js"></script>
<script src="/vendor/jquery.scrollUp.min.js"></script>

<!-- Active js -->
<script src="/js/active.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/three.js/r121/three.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
<script>
  $(function () {
    if (window.VANTA) window.VANTA.NET({
      el: '#waves',
      mouseControls: true,
      touchControls: true,
      gyroControls: false,
      minHeight: 200.00,
      minWidth: 200.00,
      scale: 1.00,
      scaleMobile: 1.00,
      color: 0x3fa4ff
    })
  })
  document.addEventListener('DOMContentLoaded', function () {
    const toc = document.querySelector('#TableOfContents');
    const content = document.querySelector('.post-content');
    const headers = content.querySelectorAll('h1, h2, h3, h4, h5, h6');

    // 기존 목차 항목에 toc-item 클래스 추가  
    toc.querySelectorAll('a').forEach(link => {
      link.classList.add('toc-item');
    });

    // 헤더에 ID 부여  
    headers.forEach((header, index) => {
      if (!header.id) {
        header.id = `section-${index}`;
      }
    });

    // 스크롤에 따른 하이라이트  
    function highlightTocItem() {
      const scrollPosition = window.scrollY;
      const tocItems = toc.querySelectorAll('.toc-item');

      // 현재 화면에 보이는 첫 번째 헤더 찾기  
      let activeIndex = -1;
      for (let i = 0; i < headers.length; i++) {
        if (headers[i].getBoundingClientRect().top >= 0) {
          activeIndex = i;
          break;
        }
      }

      // 모든 항목의 하이라이트 제거  
      tocItems.forEach(item => item.classList.remove('active'));

      // 현재 섹션의 목차 항목 하이라이트  
      if (activeIndex !== -1) {
        const activeHeader = headers[activeIndex];
        const activeLink = toc.querySelector(`a[href="#${activeHeader.id}"]`);
        if (activeLink) {
          activeLink.classList.add('active');
        }
      } else if (scrollPosition + window.innerHeight >= document.documentElement.scrollHeight) {
        // 페이지 맨 아래일 경우 마지막 항목 하이라이트  
        tocItems[tocItems.length - 1].classList.add('active');
      }
    }

    window.addEventListener('scroll', highlightTocItem);
    highlightTocItem(); // 초기 로드 시 실행  
  });

  // 코드 블록 복사 기능
  document.addEventListener('DOMContentLoaded', function() {
    // 모든 pre 태그를 찾아서 복사 버튼 추가
    const codeBlocks = document.querySelectorAll('.post-content pre:not(.mermaid)');
    
    codeBlocks.forEach(function(block) {
      // 복사 버튼 생성
      const copyButton = document.createElement('button');
      copyButton.className = 'copy-button';
      copyButton.title = '복사';
      copyButton.innerHTML = '<i class="far fa-copy"></i>';
      
      // 버튼 클릭 이벤트
      copyButton.addEventListener('click', function() {
        // 코드 텍스트 가져오기
        const code = block.querySelector('code');
        const text = code ? code.textContent : block.textContent;
        
        // 클립보드에 복사
        navigator.clipboard.writeText(text).then(function() {
          // 성공 시 아이콘 변경
          copyButton.innerHTML = '<i class="fas fa-check"></i>';
          copyButton.classList.add('copied');
          
          // 2초 후 원래 상태로 복구
          setTimeout(function() {
            copyButton.innerHTML = '<i class="far fa-copy"></i>';
            copyButton.classList.remove('copied');
          }, 2000);
        }).catch(function(err) {
          console.error('복사 실패:', err);
          copyButton.innerHTML = '<i class="fas fa-times"></i>';
          setTimeout(function() {
            copyButton.innerHTML = '<i class="far fa-copy"></i>';
          }, 2000);
        });
      });
      
      // pre 태그에 버튼 추가
      block.appendChild(copyButton);
    });
  });
</script>


<!-- Mermaid.js - only loaded when page contains mermaid code blocks -->
{{ if .Store.Get "hasMermaid" }}
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
</script>
{{ end }}

<!-- Google Analytics -->
{{ if .Site.Config.Services.GoogleAnalytics.ID }}
<script async src="https://www.googletagmanager.com/gtag/js?id={{ .Site.Config.Services.GoogleAnalytics.ID }}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "{{ .Site.Config.Services.GoogleAnalytics.ID }}");
</script>
{{ end }} 
